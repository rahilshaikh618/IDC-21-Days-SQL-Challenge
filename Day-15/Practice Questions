#1. Join patients, staff, and staff_schedule to show patient service and staff availability.
select p.patient_id, p.name, p.service,
s.staff_id, s.staff_name, s.role,
coalesce(ss.week, 0) as week,
coalesce(ss.present, 0) as present
from patients p
left join staff s
on p.service = s.service
left join staff_schedule ss
on
 s.staff_id = ss.staff_id;

#2. Combine services_weekly with staff and staff_schedule for comprehensive service analysis.
select sw.week, sw.service, sw.patients_admitted, sw.patient_satisfaction, 
s.staff_id, s.staff_name, s.role, 
ss.present
from 
services_weekly sw
left join staff s
on sw.service = s.service
left join staff_schedule ss
on
s.staff_id = ss.staff_id;

#3.Create a multi-table report showing patient admissions with staff information.
SELECT 
    p.patient_id, p.name, p.service,p.arrival_date,
    s.staff_id, s.staff_name,s.role,
    coalesce(ss.week, 0) as week,
    coalesce(ss.present, 0) as present
FROM patients p
LEFT JOIN staff s 
    ON p.service = s.service
LEFT JOIN staff_schedule ss
    ON s.staff_id = ss.staff_id
    order by week desc;
    
