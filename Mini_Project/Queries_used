# PHASE 1: Foundation & Inspection (4 Questions)

#1. INSTALL IDC PIZZA.DUMP AS IDC PIZZA SERVER
#IDC Pizza.dump is a PostgreSQL backup file. It cannot be imported into MySQL;
#it must be restored in PostgreSQL/pgAdmin.

#2. List all unique pizza categories (DISTINCT).
select distinct category from pizza_types;

#3. Display pizza_type_id, name, and ingredients, replacing NULL ingredients with "Missing Data". Show first 5 rows.
select pizza_type_id, name, coalesce(ingredients, 'Missing Data') as ingredients
from pizza_types limit 5;

#4. Check for pizzas missing a price (IS NULL).
select pizza_id, price from pizzas where price is null;

# PHASE 2: Filtering & Exploration (6 Questions)

#1. Orders placed on `'2015-01-01'` (`SELECT` + `WHERE`).
select order_id, date from orders where date = '2015-01-01';

#2. List pizzas with `price` descending.
select pizza_id, price from pizzas order by price desc;

#3. Pizzas sold in sizes `'L'` or `'XL'`.
select pizza_id, size from pizzas where size = 'L' or size = 'XL';

#4. Pizzas priced between $15.00 and $17.00.
select pizza_id, price from pizzas where price between 15.00 and 17.00;

#5. Pizzas with `"Chicken"` in the name.
select pizza_type_id, name from pizza_types where name like '%Chicken%';

#6. Orders on `'2015-02-15'` or placed after 8 PM.
select order_id, date, time from orders where date = '2015-02-15' or time > '20:00:00';

# PHASE 3: Sales Performance & Business Insights (7 Questions)

#1. Total quantity of pizzas sold (`SUM`).
select  sum(quantity) as total_pizza_sold from order_details;

#2. Average pizza price (`AVG`).
select round(avg(price),2) as avg_pizza_price from pizzas;

#3. Total order value per order (`JOIN`, `SUM`, `GROUP BY`).
select od.order_id, sum(p.price * od.quantity) as total_order_value from order_details od join pizzas p on od.pizza_id = p.pizza_id
group by od.order_id;

#4. Total quantity sold per pizza category (`JOIN`, `GROUP BY`).
select pt.category, sum(od.quantity) as pizza_sold_by_category from pizza_types pt join pizzas p on pt.pizza_type_id = p.pizza_type_id
join order_details od on p.pizza_id = od.pizza_id 
group by pt.category;

#5. Categories with more than 5,000 pizzas sold (`HAVING`).
select pt.category, sum(od.quantity) as pizza_sold_by_category from pizza_types pt join pizzas p on pt.pizza_type_id = p.pizza_type_id
join order_details od on p.pizza_id = od.pizza_id 
group by pt.category having sum(od.quantity) >5000;

#6. Pizzas never ordered (`LEFT/RIGHT JOIN`).
SELECT p.*
FROM order_details od
right JOIN pizzas p
    ON p.pizza_id = od.pizza_id
WHERE od.pizza_id IS NULL;

#7. Price differences between different sizes of the same pizza (`SELF JOIN`).
SELECT 
    p1.pizza_type_id,
    p1.size AS size_1,
    p1.price AS price_1,
    p2.size AS size_2,
    p2.price AS price_2,
    (p2.price - p1.price) AS price_difference
FROM pizzas p1
JOIN pizzas p2
    ON p1.pizza_type_id = p2.pizza_type_id
    AND p1.size < p2.size     -- ensures no duplicate or reverse comparisons
ORDER BY p1.pizza_type_id, p1.size;
